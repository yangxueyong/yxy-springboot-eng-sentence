{"version":3,"file":"collectSentence.js","sources":["pages/my/collect/collectSentence.vue","pages/my/collect/collectSentence.vue?type=page"],"sourcesContent":["<template>\n\t<view class=\"layoutCls\">\n\t\t<view class=\"scrollCls\" scroll-y=\"true\" scroll-x=\"false\">\n\t\t\t<view class=\"contentCls\" v-for=\"item in datas\" :key=\"item.id\" v-if=\"datas.length\">\n\t\t\t\t<view class=\"favoriteTimeMainCls\" >\n\t\t\t\t\t<!-- <view class=\"favoriteTextCls\">收藏时间:</view> -->\n\t\t\t\t\t<view class=\"favoriteTimeCls\">{{item.createTime}}</view>\n\t\t\t\t\t<view class=\"favoriteDelCls\" @click=\"delMyCollect(item.id)\">\n\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"25\"  ></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"zhCls\" >\n\t\t\t\t\t{{item.znName}}\n\t\t\t\t</view>\n\t\t\t\t<view class=\"translationCls\">\n\t\t\t\t\t<view class=\"engCls\" >\n\t\t\t\t\t\t{{item.hide=='1'?'***':item.enName}}\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"hidCls\">\n\t\t\t\t\t\t<uni-icons :type=\"item.hide=='1'?'eye-slash':'eye'\" size=\"25\" @click=\"eye(item)\"></uni-icons>\n\t\t\t\t\t\t<view class=\"play\" @click.stop=\"play(item, queryParams.collectType)\">\n\t\t\t\t\t\t\t<a-trumpet :isPlay=\"item.isPlay\" size=\"25\" color=\"#28B389\"></a-trumpet>\n\t\t\t\t\t\t\t<!-- <uni-icons type=\"sound\" size=\"30\"  @click=\"play(item)\"></uni-icons> -->\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view> \n\t\t\t<view class=\"loadingLayout\" v-if=\"noData || datas.length\">\n\t\t\t\t<uni-load-more :status=\"noData?'noMore':'loading'\"/>\n\t\t\t</view>\n\t\t</view> \n\t</view>\n</template>\n\n<script setup> \n\timport {ref} from \"vue\";\n\timport {getSystemWechatUserForward} from \"@/common/utils/common.js\";\n\timport {onLoad,onUnload,onReachBottom,onShareAppMessage,onShareTimeline,onPullDownRefresh} from \"@dcloudio/uni-app\"\n\timport {apiGetMyCollect,apiDelMyCollect} from \"@/common/api/apis.js\"\n\timport {getDetailVoicePath,getWordVoicePath} from \"@/common/utils/request.js\";\n\t\n\tgetSystemWechatUserForward();\n\tconst playMap = new Map();\n\t//没有更多\n\tconst noData = ref(false);\n\t\n\tconst queryParams = {\n\t\tpageNum:1,\n\t\tpageSize:10\n\t}\n\t\n\tonLoad((e)=>{\n\t\tlet {collectType=null,name=null} = e;\n\t\tqueryParams.collectType = collectType;\n\t\t//修改导航标题\n\t\tuni.setNavigationBarTitle({\n\t\t\ttitle:name\n\t\t});\n\t\tgetEngMain(); \n\t});\n\t\n\t\n\t//下拉刷新\n\tonPullDownRefresh(()=>{\n\t\tqueryParams.pageNum = 1;\n\t\tgetEngMain();\n\t})\n\t\n\t\n\t//触底加载更多\n\tonReachBottom(()=>{\n\t\tconsole.log(\"触地了-->\");\n\t\tif(noData.value) return;\n\t\tqueryParams.pageNum++\n\t\tgetEngMain();\n\t})\n\t\n\t//我收藏的句子\n\tconst datas=ref([]);\n\t\n\tconst getEngMain =async(code)=>{\n\t\t// uni.showLoading({\n\t\t// \ttitle:\"加载中..\"\n\t\t// })\n\t\tlet res =await apiGetMyCollect(queryParams); \n\t\tconsole.log(\"获取到的收藏数据->\",res);  \n\t\tdatas.value  =  [...datas.value,...res.data] ;\n\t\t\n\t\tif(queryParams.pageSize > res.data.length){\n\t\t\tnoData.value = true;\n\t\t}\n\t\t\n\t\tuni.stopPullDownRefresh();\n\t\tuni.hideLoading(); \n\t}\n\t\n\tconst delMyCollect=async(id)=>{ \n\t\tlet res =await apiDelMyCollect({\n\t\t\tid\n\t\t});   \n\t\tdatas.value = datas.value.filter(item => item.id !== id); \n\t\tuni.stopPullDownRefresh();\n\t\tuni.hideLoading(); \n\t}\n\t\n\t\n\t\n\t// 显示或隐藏\n\tfunction eye(e){\n\t\te.hide = !e.hide;\n\t}\n\tfunction deleteFavorite(e){\n\t\t\n\t}\n\tfunction play(e, type){\n\t\tlet eid = type + e.id; \n\t\t\n\t\te.isPlay = !e.isPlay;\n\t\tif(!e.isPlay){\n\t\t\tif(playMap != null && playMap.has(eid)){\n\t\t\t\tplayMap.get(eid).stop();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif(playMap != null){\n\t\t\tplayMap.forEach((value, id) => {\n\t\t\t  value.stop();\n\t\t\t  findItemById(id).isPlay = false;\n\t\t\t});\n\t\t}\n\t\te.isPlay = true;\n\t\t\n\t\tlet audioUrl = null;\n\t\tif(type == \"detail\"){\n\t\t\taudioUrl = getDetailVoicePath(e);\n\t\t}else{\n\t\t\taudioUrl = getWordVoicePath(e);\n\t\t}\n\t\t\n\t\tconsole.log(\"音频地址->\",audioUrl);\n\t\tconst innerAudioContext = uni.createInnerAudioContext();\n\t\tinnerAudioContext.autoplay = true;\n\t\tinnerAudioContext.src = audioUrl;\n\t\tinnerAudioContext.onPlay(() => {\n\t\t  console.log('开始播放');\n\t\t  uni.hideLoading();\n\t\t});\n\t\tinnerAudioContext.onError((res) => {\n\t\t\tconsole.log(res)\n\t\t  // console.log(res.errMsg);\n\t\t  // console.log(res.errCode);\n\t\t  uni.hideLoading();\n\t\t});\n\t\tinnerAudioContext.onEnded((res)=>{\n\t\t\tconsole.log(\"停止播放->\",res);\n\t\t\te.isPlay = false;\n\t\t\tuni.hideLoading();\n\t\t})\n\t\t\n\t\tplayMap.set(eid, innerAudioContext);\n\t}\n\t \n\tfunction findItemById(id) {\n\t    return datas.value.find(item => id.includes(item.id));\n\t}\n\t   \n\t  \n</script>\n\n<style lang=\"scss\" scoped>\n.layoutCls{\n\t\twidth: 100%;\n\t\theight: 100vh;\n\t\tposition: relative; \n\t\t .scrollCls{  \n\t\t\t// margin-top: 20rpx;\n\t\t\twidth: 100%; \n\t\t\theight: 100vh;\n\t\t\tpadding: 20rpx; \n\t\t\tbox-sizing: border-box; \n\t\t\t.contentCls{ \n\t\t\t\tmargin-top: 60rpx; \n\t\t\t\tbackground: #f3f7f8; \n\t\t\t\tborder-radius: 20rpx;\n\t\t\t\tpadding: 15rpx;  \n\t\t\t\tposition: relative; \n\t\t\t\t.favoriteTimeMainCls{\n\t\t\t\t\tfont-size: 25rpx;\n\t\t\t\t\tpadding: 10rpx;\n\t\t\t\t\tborder-bottom: 1px solid #ebf1f3; \n\t\t\t\t\tdisplay: flex;  \n\t\t\t\t\talign-items: center;\n\t\t\t\t\tbackground: rgba(0, 0, 0, 0.1); \n\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\tvertical-align: middle;\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\t// color: #fff;\n\t\t\t\t\tright: 0;\n\t\t\t\t\tmargin-top: -50rpx;\n\t\t\t\t\t// padding: 20rpx;\n\t\t\t\t\tborder-radius: 20rpx;\n\t\t\t\t\t// top: 0rpx;\n\t\t\t\t\t.favoriteTextCls{\n\t\t\t\t\t\t// background: yellow;\n\t\t\t\t\t\tdisplay: inline-block; \n\t\t\t\t\t\tvertical-align: middle\n\t\t\t\t\t}\n\t\t\t\t\t.favoriteTimeCls{\n\t\t\t\t\t\tdisplay: inline-block; \n\t\t\t\t\t\t// color:$text-font-color-2;\n\t\t\t\t\t\tvertical-align: middle;\n\t\t\t\t\t\tfont-family: monospace; \n\t\t\t\t\t\tfont-weight: normal; \n\t\t\t\t\t\t// width: 19ch;\n\t\t\t\t\t\t// padding-left: 10rpx;\n\t\t\t\t\t\t// background: red;\n\t\t\t\t\t}\n\t\t\t\t\t.favoriteDelCls{\n\t\t\t\t\t\tdisplay: inline-block; \n\t\t\t\t\t\tvertical-align: middle;\n\t\t\t\t\t\t// right: 0;\n\t\t\t\t\t\t:deep(){\n\t\t\t\t\t\t\t.uni-icons{\n\t\t\t\t\t\t\t\tcolor:$brand-theme-color !important;\n\t\t\t\t\t\t\t\t padding-left: 20rpx;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t.zhCls{\n\t\t\t\t\tfont-size: 25rpx;\n\t\t\t\t\tpadding: 10rpx;\n\t\t\t\t\tborder-bottom: 1px solid #ebf1f3;\n\t\t\t\t}\n\t\t\t\t.translationCls{\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tposition: relative; \n\t\t\t\t\t.engCls{\n\t\t\t\t\t\tflex: 1;\n\t\t\t\t\t\twidth: 0; \n\t\t\t\t\t\tpadding: 10rpx;\n\t\t\t\t\t}\n\t\t\t\t\t.hidCls{\n\t\t\t\t\t\twidth: 150rpx;\t \n\t\t\t\t\t\t// background: red;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\t// position: absolute; \n\t\t\t\t\t\tjustify-content: center;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\tright: 0;\n\t\t\t\t\t\t:deep(){\n\t\t\t\t\t\t\t.uni-icons{\n\t\t\t\t\t\t\t\tcolor:$brand-theme-color !important;\n\t\t\t\t\t\t\t\t padding-left: 20rpx;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\t\n\t\t\t\t\t}\n\t\t\t\t }\n\t\t\t }\n\t\t\t\n\t\t }\n\t\t \n\t\t \n\t\t\n\t }\n</style>\n\n","import MiniProgramPage from '/Users/yxy/work/java/demo/yxy-springboot-eng-sentence/yxy-springboot-eng-sentence/my-eng/pages/my/collect/collectSentence.vue'\nwx.createPage(MiniProgramPage)"],"names":["getSystemWechatUserForward","ref","onLoad","uni","onPullDownRefresh","onReachBottom","apiGetMyCollect","apiDelMyCollect","getDetailVoicePath","getWordVoicePath"],"mappings":"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"}