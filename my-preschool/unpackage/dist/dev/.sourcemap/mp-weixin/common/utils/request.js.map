{"version":3,"file":"request.js","sources":["common/utils/request.js"],"sourcesContent":["import {getSystemWechatUser} from \"@/common/utils/common.js\"\n \n// const BASE_URL = 'http://127.0.0.1:8080'; \nconst BASE_URL = 'https://www.yangxuexue.xyz';\n\n \nexport function playAll_failVoice(){\n\tplayVoice(BASE_URL + \"/voice/all_fail.mp3\");\n}\n\nexport function playAll_successVoice(){\n\tplayVoice(BASE_URL + \"/voice/all_success.mp3\");\n}\n\nexport function playItem_failVoice(){\n\tplayVoice(BASE_URL + \"/voice/item_fail.mp3\");\n}\n\nexport function playItem_successVoice(){\n\tplayVoice(BASE_URL + \"/voice/item_success.mp3\");\n}\n\nlet innerAudioContext = null;\nexport function playVoice(audioUrl){ \n\tif(innerAudioContext == null){\n\t\tinnerAudioContext = uni.createInnerAudioContext();\n\t\tinnerAudioContext.autoplay = true;\n\t}else{\n\t\tinnerAudioContext.stop();\n\t}\n\tinnerAudioContext.src = audioUrl;\n\tinnerAudioContext.play();\n\tinnerAudioContext.onPlay(() => { \n\t  uni.hideLoading();\n\t});\n\tinnerAudioContext.onError((res) => {\n\t\tconsole.log(res) \n\t  uni.hideLoading();\n\t});\n\tinnerAudioContext.onEnded((res)=>{\n\t\tconsole.log(\"停止播放->\",res); \n\t\tuni.hideLoading();\n\t})\n}\n\nexport function request(config={}){\t \n\tlet {\n\t\turl,\n\t\tdata={},\n\t\tmethod=\"GET\",\n\t\theader={}\n\t} = config\n\t\n\tconsole.log(\"url->\",url);\n\tconsole.log(\"data->\",data);\n\t\n\tlet user = getSystemWechatUser();  \n\t\n\turl = BASE_URL+url\n\theader['openId'] = user.openid;\n\theader['thirdType'] = \"wechat\"; \n\theader['X-WX-SERVICE'] = \"springboot-ndhb\"; \n\t\n\treturn new Promise((resolve,reject)=>{\t\t\n\t\tuni.request({\n\t\t\turl,\n\t\t\tdata,\n\t\t\tmethod,\n\t\t\theader, \n\t\t\tsuccess:res=>{ \n\t\t\t\tif(res.data.code==\"200\"){\n\t\t\t\t\tresolve(res.data)\n\t\t\t\t}else if(res.data.code!=\"200\"){\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle:\"错误提示\",\n\t\t\t\t\t\tcontent:res.data.msg,\n\t\t\t\t\t\tshowCancel:false\n\t\t\t\t\t})\n\t\t\t\t\treject(res.data)\n\t\t\t\t}else{\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle:res.data.msg,\n\t\t\t\t\t\ticon:\"none\"\n\t\t\t\t\t})\n\t\t\t\t\treject(res.data)\n\t\t\t\t}\t\t\t\t\n\t\t\t},\n\t\t\tfail:err=>{\n\t\t\t\treject(err)\n\t\t\t}\n\t\t})\n\t})\n}\n"],"names":["uni"],"mappings":";;AAGA,MAAM,WAAW;AAGV,SAAS,oBAAmB;AAClC,YAAU,WAAW,qBAAqB;AAC3C;AAEO,SAAS,uBAAsB;AACrC,YAAU,WAAW,wBAAwB;AAC9C;AAEO,SAAS,qBAAoB;AACnC,YAAU,WAAW,sBAAsB;AAC5C;AAEO,SAAS,wBAAuB;AACtC,YAAU,WAAW,yBAAyB;AAC/C;AAEA,IAAI,oBAAoB;AACjB,SAAS,UAAU,UAAS;AAClC,MAAG,qBAAqB,MAAK;AAC5B,wBAAoBA,cAAAA,MAAI;AACxB,sBAAkB,WAAW;AAAA,EAC/B,OAAM;AACJ,sBAAkB,KAAI;AAAA,EACtB;AACD,oBAAkB,MAAM;AACxB,oBAAkB,KAAI;AACtB,oBAAkB,OAAO,MAAM;AAC7BA,kBAAG,MAAC,YAAW;AAAA,EAClB,CAAE;AACD,oBAAkB,QAAQ,CAAC,QAAQ;AAClCA,kBAAAA,MAAY,MAAA,OAAA,iCAAA,GAAG;AACdA,kBAAG,MAAC,YAAW;AAAA,EAClB,CAAE;AACD,oBAAkB,QAAQ,CAAC,QAAM;AAChCA,kBAAY,MAAA,MAAA,OAAA,iCAAA,UAAS,GAAG;AACxBA,kBAAG,MAAC,YAAW;AAAA,EACjB,CAAE;AACF;;;;;"}